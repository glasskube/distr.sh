---
title: Run Distr on macOS
description: While running the Distr agent on Windows or Linux is straightforward, macOS may require a few additional tweaks.
sidebar:
  order: 6
---
import {Aside, Code, TabItem, Tabs} from '@astrojs/starlight/components';

Distr is designed to be as versatile as possible. That involves being able to run on a variety of operating systems successfully. While most enterprise environments run on Linux-based VMs, there are always exceptions. What if, for testing purposed for instance, MacOS is the chosen operating system for running Distr agents?

If you're using Windows or Linux, the [Quickstart guide](/docs/getting-started/quickstart/) should cover everything you need. But if you're setting up Distr on MacOS, follow these steps to ensure a smooth deployment experience.

## Running Distr agents
<Aside type="note">
When we talk about "running Distr," we're specifically referring to running the [Distr agents](/docs/product/agents/). Since Distr can also be self-hosted, much of this guide could apply to running Distr in a local Docker environment as well. However, we'll focus on the SaaS version of Distr and properly configuring a local MacOS target environment to deploy applications through Distr.
</Aside>

## Prerequisites
Before you begin, make sure you have:

- A macOS system with admin access
- [Docker Desktop](https://www.docker.com/products/docker-desktop/) installed
- Access to the [Distr platform](https://app.distr.sh/)

## 1. Install Docker Desktop
First, install [Docker Desktop for Mac](https://docs.docker.com/desktop/setup/install/mac-install/). Follow the installation instructions provided by Docker.

## 2. Verify the Docker Context
Check the local Docker context being used:

**Run:** 

```sh
docker context ls
```

Expected output: 

```sh
NAME              DESCRIPTION                               DOCKER ENDPOINT                                  ERROR
default           Current DOCKER_HOST based configuration   unix:///var/run/docker.sock
desktop-linux *   Docker Desktop                            unix:///Users/jakepage/.docker/run/docker.sock
```

<Aside type="caution">
When Docker Desktop runs on macOS, it creates a lightweight Linux VM, and the `desktop-linux` context points to the Docker daemon within this VM. However, Distr expects to connect to the default Docker socket (`/var/run/docker.sock`). This mismatch can cause connectivity issues, especially when pulling or deploying container images. Setting the context to `default` aligns the Docker CLI with the expected Docker endpoint, ensuring Distr can interact with the Docker daemon properly.
</Aside>

If Docker is set to the `desktop-linux` context, you might encounter errors in the container logs like:

```sh
unable to get image 'postgres:17.3-alpine3.20': Cannot connect to the Docker daemon at unix:///Users/jakepage/.docker/run/docker.sock. Is the docker daemon running?
```

## 3. Set the Docker Context to `default`

To switch the Docker context to `default`, run:

```sh
docker context use default
```

Expected output:

```sh
NAME            DESCRIPTION                               DOCKER ENDPOINT                                  ERROR
default *       Current DOCKER_HOST based configuration   unix:///var/run/docker.sock
desktop-linux   Docker Desktop                            unix:///Users/jakepage/.docker/run/docker.sock
```

This should be all that's needed, now [test](/docs/guides/distr-on-macos/#5-test-the-setup) your setup by creating a deployment on Distr.

## 4. Test the Setup

To verify everything is configured correctly, try [deploying an application](/docs/guides/onboarding-a-docker-app/#creating-a-new-deployment) through Distr. If there are no errors related to Docker socket access, your setup is good to go.


If, during installation, you encounter the following error message:

```sh
docker.credentials.errors.InitializationError: docker-credential-desktop not installed or not available in PATH
```
then you will need to update the Docker config file in step 5.

## 5. Update the Docker Config File

The above error indicates that Docker is configured to use a credential store called "desktop," but the corresponding executable `docker-credential-desktop` is either not installed or not accessible through the system's PATH.

#### Why this happens

<Aside tag="info">
When Docker is configured to use a credential store, it tries to invoke an external binary (docker-credential-NAME). On macOS, `docker-credential-osxkeychain` is generally preferred because it integrates well with the macOS Keychain. Using `docker-credential-desktop` can lead to path issues, especially if the Docker Desktop installation did not properly add this helper to the system's PATH.
</Aside>

#### How to fix it
Check your docker config file and verify which `credsStore` is being used? 

Run:

```sh
cat ~/.docker/config.json
```
Expected output:

```json
{
    "auths": {},
    "credStore" : "desktop"
}
```

#### Use `docker-credential-osxkeychain` instead.

Since you're on a Mac, you could use `docker-credential-osxkeychain` instead of `docker-credential-desktop`.

Install `docker-credential-helper`

```sh
brew install docker-credential-helper
```

Verify `docker-credential-osxkeychain` is available.

```sh
$ docker-credential-osxkeychain version
docker-credential-osxkeychain (github.com/docker/docker-credential-helpers) v0.8.2
```

#### Edit the Docker config file
Now, we need to update Docker's config file to use `osxkeychain` instead of `desktop`.

#####  Open the config file in `nano` or Vim.
Run this command in your terminal:

```sh
nano ~/.docker/config.json
```

This will open the file in a simple text editor inside your terminal.

##### Find the `credStore` line
Look for this line:

```json
"credStore": "desktop"
```

##### Change `"desktop"` to `"osxkeychain"`
Modify it so it looks like this:

```json
"credStore": "osxkeychain"
```

Be careful not to delete the quotation marks or any commas.

##### Save the file
Once you've made the change, follow these steps to save and exit:

- **Press `CTRL + X`** to start exiting.
- **Press `Y`** to confirm saving the changes.
- **Press `Enter`** to save with the same filename.

##### Confirm the change
Run:

```sh
cat ~/.docker/config.json
```

You should see:

```json
{
    "auths": {},
    "credStore": "osxkeychain"
}
```

## 6. Test the Setup

To verify everything is configured correctly, try [deploying an application](/docs/guides/onboarding-a-docker-app/#creating-a-new-deployment) through Distr. If there are no errors related to Docker socket access, your setup is good to go.

---
With these steps, your MacOS environment should be fully configured to run Distr agents without issues. If you encounter any problems, feel free to reach out to us on [Discord](https://discord.gg/6qqBSAWZfW) or via email at support@glasskube.com.
