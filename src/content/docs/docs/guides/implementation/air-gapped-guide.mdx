---
title: Air-Gapped Implementation Guide
description: Step-by-step instructions for implementing air-gapped customer deployments
sidebar:
  order: 4
---

import {Aside, Steps, Tabs, TabItem} from '@astrojs/starlight/components';
import ThemeImage from '../../../../../components/ThemeImage.astro';

This guide provides practical steps for implementing the Air-Gapped deployment model for customers with highly restricted environments isolated from public networks.

<Aside type="note">
  Air-gapped deployments require special consideration and often custom
  solutions. Contact our team for personalized assistance with implementing this
  model.
</Aside>

## Prerequisites

Before implementing this model, ensure you have:

- An active Distr account with vendor access
- Software packaged as Docker images or Helm charts
- A clear understanding of your customer's security requirements
- Procedures for secure artifact transfer (for completely air-gapped environments)

### Solution Architecture

<ThemeImage
  lightSrc="/src/assets/docs/use-cases/airgapped/airgapped-light.png"
  darkSrc="/src/assets/docs/use-cases/airgapped/airgapped-dark.png"
  alt="Fully-Self-Managed diagram"
/>

## Implementation Options

There are two primary approaches for air-gapped deployments, depending on the severity of the customer's isolation requirements:

<Tabs>
<TabItem label="IP Whitelisting Approach">

This approach works for environments that can selectively allow outbound connections to specific IP addresses.

<Steps>
1. **Set Up Registry with Fixed IP**
2. **Onboard Your Application**
3. **Customer Network Configuration**
4. **Create Customer-Specific Credentials**
5. **Verification Process**
6. **Establish Secure Update Workflow**
</Steps>

### 1. Set Up Registry with Fixed IP

Configure your Distr Registry with fixed, dedicated IP addresses:

- Contact Distr support to request a fixed IP allocation
- Document all IP addresses and network requirements
- Configure your registry for enhanced security controls
- Set up multi-factor authentication for all access

### 2. Onboard Your Application

Prepare your application with air-gapped considerations:

- Package your application as Docker images or Helm charts
- Ensure all dependencies are included in the packages
- Remove any external service dependencies
- Include comprehensive offline documentation
- Prepare offline licensing mechanisms

### 3. Customer Network Configuration

Work with your customer to establish network access:

- Provide the fixed IP addresses for whitelisting
- Document required ports and protocols
- Define network traffic patterns for security review
- Create a security document for the customer's security team
- Provide sample firewall rules for common platforms

### 4. Create Customer-Specific Credentials

Generate secure credentials for registry access:

- Create dedicated customer access with enhanced security
- Configure IP-based access restrictions
- Implement certificate-based authentication
- Set up audit logging for all access attempts
- Configure expiring credentials with rotation policies

### 5. Verification Process

Establish a verification process:

- Create a testing protocol for initial connectivity
- Implement verification of artifact integrity
- Document the verification process for compliance
- Prepare troubleshooting guides for connectivity issues
- Test the entire process in a simulated environment

### 6. Establish Secure Update Workflow

Create a secure update process:

- Define your release notification process
- Implement cryptographic signing of all artifacts
- Create a verification mechanism for customers
- Establish a secondary verification channel
- Document the entire update workflow
   
</TabItem>
<TabItem label="Fully Air-Gapped Approach">

This approach is for environments with complete isolation from external networks.

<Steps>
1. **Self-Hosted Registry Setup**
2. **Onboard Your Application**
3. **Physical Transfer Mechanism**
4. **Customer Environment Setup**
5. **Update Distribution Process**
</Steps>

### 1. Self-Hosted Registry Setup

Prepare a self-hosted registry solution:

- Contact Distr support to request self-hosted registry software
- Document hardware and software requirements
- Create deployment instructions for air-gapped environments
- Implement enhanced security controls for the registry
- Define backup and recovery procedures

### 2. Onboard Your Application

Prepare your application with complete offline operation:

- Package your application with all dependencies
- Remove any online requirements or check-ins
- Include offline activation mechanisms
- Create offline documentation
- Implement offline telemetry storage

### 3. Physical Transfer Mechanism

Establish secure physical transfer procedures:

- Define secure media types (encrypted drives, secure USB devices)
- Create chain-of-custody documentation
- Implement cryptographic verification of contents
- Define secure media handling procedures
- Create secure media destruction protocols

### 4. Customer Environment Setup

Prepare documentation for customer setup:

- Create detailed installation instructions
- Document registry import procedures
- Provide verification mechanisms for imports
- Include troubleshooting guides for common issues
- Define backup and recovery procedures

### 5. Update Distribution Process

Establish a process for delivering updates:

- Define release schedule and notification process
- Create a secure packaging process for updates
- Document update verification procedures
- Include rollback instructions
- Establish a physical delivery schedule and procedure

</TabItem>
</Tabs>

## Registry Access Methods (IP Whitelisting Approach)

For customers using the IP whitelisting approach, access to the registry involves:

### Docker Registry Access

```bash
# Login to the registry (requires whitelisted network)
docker login registry.yourdomain.distr.sh -u customer-username -p customer-token

# Pull an image
docker pull registry.yourdomain.distr.sh/your-application:version
```

### Helm Registry Access

```bash
# Add the Helm repository (requires whitelisted network)
helm repo add your-repo https://registry.yourdomain.distr.sh/helm/customer-name --username customer-username --password customer-token

# Update repositories
helm repo update

# Install a chart
helm install your-application your-repo/your-application --version 1.0.0
```

## Artifact Distribution (Fully Air-Gapped Approach)

For completely air-gapped environments:

### Preparing Artifacts

```bash
# Create an export bundle
distr-cli export --customer-id customer-id --application-name your-application --version 1.0.0 --output /secure-media/export.tar.gz

# Sign the export bundle
distr-cli sign --file /secure-media/export.tar.gz --output /secure-media/export.tar.gz.sig
```

### Importing Artifacts

```bash
# Verify the signature
distr-cli verify --file /secure-media/export.tar.gz --signature /secure-media/export.tar.gz.sig

# Import the bundle to the self-hosted registry
distr-cli import --file /secure-media/export.tar.gz --registry-url http://local-registry:5000
```

## Security Considerations

Air-gapped deployments require exceptional security measures:

- All artifacts should be cryptographically signed
- Physical media should be encrypted
- Chain of custody should be documented
- Media should be securely erased after use
- All access should be strictly controlled and audited

<Aside type="tip">
  Consider creating a dedicated security procedures document specifically for
  your air-gapped customers.
</Aside>

## Compliance Documentation

For highly regulated industries, prepare documentation that covers:

- Software provenance
- Security scan results
- Cryptographic verification procedures
- Media handling procedures
- Audit trail for all delivered artifacts

## Best Practices

- Minimize the frequency of updates to reduce operational overhead
- Bundle updates when possible to reduce transfer operations
- Provide comprehensive documentation for offline use
- Establish a secondary communication channel for support
- Create dedicated points of contact for air-gapped customers

## Next Steps

After implementing the Air-Gapped model, you might want to:

- [Set up specialized support procedures](/docs/guides/admin/support-procedures/) for air-gapped customers
- [Create customized security documentation](/docs/guides/admin/security-documentation/) for your software
- [Implement enhanced compliance reporting](/docs/guides/admin/compliance-reporting/) for regulated industries
