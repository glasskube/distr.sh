---
import Layout from '~/layouts/StarlightLayout.astro';
import SinglePost from '~/components/blog/SinglePost.astro';
import CTASection from '~/components/home/CTASection.astro';
import {getSortedPosts} from '~/utils/blog';
import type {Post} from '~/types';

export async function getStaticPaths() {
  let posts = await getSortedPosts();

  return posts.map(post => {
    return {
      params: {
        slug: post.data.slug + '/',
      },
      props: {
        post: post,
      },
    };
  });
}

export interface Props {
  allPosts: Post[];
  post: Post;
}

const {slug} = Astro.params;
const {post} = Astro.props;
---

<Layout title={post.data.title} description={post.data.description}>
  <div class="mx-auto max-w-7xl px-6 sm:px-8 lg:px-10">
    <SinglePost post={post} url={slug} />
  </div>
  <CTASection
    title="Want to learn more?"
    description=""
    primaryButton={{
      text: 'Download Whitepaper',
      href: '/white-paper/building-blocks/',
    }}
    secondaryButton={{
      text: 'Book Demo',
      href: 'https://cal.glasskube.com/team/gk/demo',
    }}
  />
</Layout>
